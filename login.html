<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlanB - ログイン</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="page-login">

<div class="login-container">
    <h1 class="login-title">PlanB</h1>
    
    <form id="loginForm" onsubmit="handleLogin(event)">
        <div class="form-group">
            <label for="email">メールアドレス</label>
            <input type="email" id="email" placeholder="example@email.com" required>
        </div>

        <div class="form-group">
            <label for="password">パスワード</label>
            <input type="password" id="password" placeholder="••••••••" required>
        </div>

        <button type="submit" class="btn-primary">ログイン</button>
    </form>

    <div class="signup-link">
        アカウントをお持ちでない方は
        <a onclick="goToSignup()">新規登録</a>
    </div>
</div>

<script>
    // ログイン処理の実装（サーバー通信版）
    async function handleLogin(event) {
        event.preventDefault();
        
        const emailInput = document.getElementById('email').value;
        const passwordInput = document.getElementById('password').value;

        if (!emailInput || !passwordInput) {
            alert('メールアドレスとパスワードを入力してください');
            return;
        }

        try {
            // サーバーのAPIにデータを送信 (POST)
            const response = await fetch("/api/login", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    email: emailInput,
                    password: passwordInput
                })
            });

            // サーバーからの結果を受け取る
            const result = await response.json();

            if (result.success) {
                console.log('認証成功');
                // ホーム画面へ遷移
                window.location.href = 'home.html';
            } else {
                console.log('認証失敗');
                alert('メールアドレスまたはパスワードが間違っています。');
            }

        } catch (error) {
            console.error("通信エラー:", error);
            alert("サーバーとの通信に失敗しました。");
        }
    }

    function goToSignup() {
        window.location.href = 'signup.html';
    }
</script>

</body>
</html>