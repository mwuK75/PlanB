<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlanB - æ··é›‘å›é¿ãƒ«ãƒ¼ãƒˆ</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="app-container">
    <header>
        <div class="logo" onclick="goHome()">
            <div class="logo-icon">âœ¨</div>
            <span>PlanB</span>
        </div>
        <button style="border:none; background:none; font-size:1.2rem;">ğŸ’¬</button>
    </header>

    <main>
        <!-- çµæœç”»é¢ -->
        <div id="phase-result" style="display: block; padding: 20px;">
            <div class="result-header">
                <div>
                    <h2 style="font-size:1.2rem; margin:0;">3ã¤ã®PlanB</h2>
                    <p style="font-size:0.8rem; color:#6b7280; margin:0;">æ··é›‘å›é¿ãƒ«ãƒ¼ãƒˆ</p>
                </div>
                <a href="home.html" style="color:#7c3aed; font-size:0.9rem; text-decoration:none;">æ¡ä»¶å¤‰æ›´</a>
            </div>
            
            <!-- JavaScriptãŒå‹•çš„ã«ç”Ÿæˆ -->
            <div id="plans-list"></div>
        </div>
    </main>
</div>

<script>
    // --- JavaScriptã®åŸºæœ¬ï¼šãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆé…åˆ—ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ ---
    const basePlans = [
        {
            id: 1,
            name: "Blue Bottle Coffee",
            category: "Cafe",
            distance: "3åˆ†",
            wait: "ç©ºå¸­ã‚ã‚Š",
            congestionLevel: "low",
            price: "Â¥600~",
            desc: "ã“ã“ãªã‚‰ä»Šã™ãåº§ã‚Œã¾ã™ã€‚é›»æºã‚‚ã‚ã‚Šã€‚",
            tags: ["#é™ã‹", "#ä½œæ¥­OK"],
            icon: "â˜•"
        },
        {
            id: 2,
            name: "TSUTAYA BOOK APARTMENT",
            category: "Lounge",
            distance: "5åˆ†",
            wait: "ã‚„ã‚„æ··é›‘",
            congestionLevel: "medium",
            price: "Â¥1200~",
            desc: "é´ã‚’è„±ã„ã§ãƒªãƒ©ãƒƒã‚¯ã‚¹ã€‚å……é›»å®Œäº†ã¾ã§ã“ã“ã§ã€‚",
            tags: ["#å€‹å®¤ã‚ã‚Š", "#æ¼«ç”»"],
            icon: "ğŸ“–"
        },
        {
            id: 3,
            name: "ã‚«ãƒ©ã‚ªã‚±é¤¨ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ",
            category: "Entertainment",
            distance: "1åˆ†",
            wait: "å³å…¥å®¤å¯",
            congestionLevel: "low",
            price: "Â¥800~",
            desc: "30åˆ†ã ã‘æ­Œã£ã¦ã‚¹ãƒˆãƒ¬ã‚¹ç™ºæ•£ã—ã¾ã›ã‚“ã‹ï¼Ÿ",
            tags: ["#é˜²éŸ³", "#é§…ãƒã‚«"],
            icon: "ğŸ¤"
        },
        {
            id: 4,
            name: "éš ã‚Œå®¶ã‚¤ã‚¿ãƒªã‚¢ãƒ³ VINO",
            category: "Restaurant",
            distance: "8åˆ†",
            wait: "ç©ºå¸­ã‚ãšã‹",
            congestionLevel: "high",
            price: "Â¥1500~",
            desc: "è·¯åœ°è£ãªã®ã§ç©´å ´ã§ã™ã€‚ãƒ”ã‚¶ãŒçµ¶å“ã€‚",
            tags: ["#ãŠã—ã‚ƒã‚Œ", "#ãƒ©ãƒ³ãƒ"],
            icon: "ğŸ"
        },
        {
            id: 5,
            name: "è¿‘ä»£ç¾è¡“é¤¨ ãƒ­ãƒ“ãƒ¼",
            category: "Public",
            distance: "6åˆ†",
            wait: "ç©ºã„ã¦ã„ã‚‹",
            congestionLevel: "low",
            price: "Â¥0",
            desc: "é›¨å®¿ã‚Šã«æœ€é©ã€‚é™ã‹ã§è½ã¡ç€ã‘ã¾ã™ã€‚",
            tags: ["#ç„¡æ–™", "#å±‹å†…"],
            icon: "ğŸ›ï¸"
        }
    ];

    // --- JavaScripté–¢æ•°ï¼šãƒ­ã‚¸ãƒƒã‚¯å‡¦ç† ---
    function generatePlansData(situation) {
        let filtered = [...basePlans];
        
        // æ¡ä»¶åˆ†å²ï¼ˆif/elseï¼‰
        if (situation === 'rain') {
            filtered = filtered.filter(p => ["Lounge", "Entertainment", "Public", "Cafe"].includes(p.category));
        } else if (situation === 'full') {
            filtered = filtered.filter(p => p.congestionLevel === 'low');
        } else if (situation === 'late') {
            filtered = filtered.filter(p => ["Cafe", "Lounge", "Public"].includes(p.category));
        }

        // ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«
        return filtered.sort(() => Math.random() - 0.5).slice(0, 3);
    }

    // --- JavaScriptè¦ç´ ï¼šHTMLãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç”Ÿæˆ ---
    function renderPlans(plans) {
        const container = document.getElementById('plans-list');
        container.innerHTML = ''; // å‰ã®ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢

        // ãƒ«ãƒ¼ãƒ—å‡¦ç†ï¼ˆforEachï¼‰
        plans.forEach(plan => {
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è‰²ã¨ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’åˆ¤å®š
            let statusClass = 'status-low';
            let statusEmoji = 'ğŸŸ¢';
            
            if (plan.congestionLevel === 'medium') { 
                statusClass = 'status-medium'; 
                statusEmoji = 'ğŸŸ¡';
            }
            if (plan.congestionLevel === 'high') { 
                statusClass = 'status-high'; 
                statusEmoji = 'ğŸ”´';
            }

            // ã‚¿ã‚°ã®HTMLç”Ÿæˆ
            const tagsHtml = plan.tags.map(tag => `<span class="tag">${tag}</span>`).join('');

            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«ã‚’ä½¿ç”¨ã—ãŸHTMLæ§‹ç¯‰
            const cardHtml = `
                <div class="plan-card">
                    <div class="card-content">
                        <div class="card-header">
                            <div class="card-icon">${plan.icon}</div>
                            <div class="card-title">
                                <h3>${plan.name}</h3>
                                <p>${plan.category} â€¢ æ­©ã„ã¦${plan.distance}</p>
                            </div>
                        </div>
                        <p class="card-description">${plan.desc}</p>
                        <div class="tags">${tagsHtml}</div>
                        <div class="card-footer">
                            <div class="card-footer-left">
                                <span class="status-badge ${statusClass}">
                                    ${statusEmoji} ${plan.wait}
                                </span>
                                <span class="card-price">äºˆç®—: ${plan.price}</span>
                            </div>
                            <button class="btn-go">ã“ã“ã«è¡Œã â†’</button>
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML += cardHtml;
        });
    }

    // ãƒ›ãƒ¼ãƒ ç”»é¢ã¸æˆ»ã‚‹
    function goHome() {
        window.location.href = 'home.html';
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ—ãƒ©ãƒ³å€™è£œã‚’ç”Ÿæˆãƒ»è¡¨ç¤º
    window.addEventListener('load', () => {
        const situation = new URLSearchParams(window.location.search).get('situation') || 'full';
        const plans = generatePlansData(situation);
        renderPlans(plans);
    });
</script>

</body>
</html>
